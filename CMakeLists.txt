# halo3_cache_release - ReXGlue Recompiled Project
# Generated by: rexglue init
#
# This file is SDK-managed. Running 'rexglue migrate' will overwrite it.

cmake_minimum_required(VERSION 3.25)
project(halo3_cache_release LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

set(REXSDK_DIR "" CACHE PATH "Path to rexglue-sdk source tree")
if(REXSDK_DIR)
    add_subdirectory("${REXSDK_DIR}" rexglue-sdk)
else()
    find_package(rexglue QUIET CONFIG)
    if(NOT rexglue_FOUND)
        message(FATAL_ERROR
            "ReXGlue SDK not found. Either:\n"
            "  - Set REXSDK_DIR to the rexglue-sdk source tree (e.g. thirdparty/rexglue-sdk)\n"
            "  - Install the SDK package and ensure it is on CMAKE_PREFIX_PATH")
    endif()
endif()

# Sources
set(HALO3_CACHE_RELEASE_SOURCES
    src/main.cpp
    src/stubs.cpp
)

# Include generated code if codegen has been run
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/generated/sources.cmake")
    include(generated/sources.cmake)
    list(APPEND HALO3_CACHE_RELEASE_SOURCES ${GENERATED_SOURCES})
endif()

if(WIN32)
    add_executable(halo3_cache_release WIN32 ${HALO3_CACHE_RELEASE_SOURCES})
else()
    add_executable(halo3_cache_release ${HALO3_CACHE_RELEASE_SOURCES})
endif()

target_include_directories(halo3_cache_release PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/generated
)

target_link_libraries(halo3_cache_release PRIVATE
    rex::core
    rex::system
    rex::kernel
    rex::graphics
    rex::ui
)

# Platform entry point, ReXApp source, and platform-specific settings
rexglue_configure_target(halo3_cache_release)

# Codegen target - run 'cmake --build . --target halo3_cache_release_codegen'
add_custom_target(halo3_cache_release_codegen
    COMMAND $<TARGET_FILE:rex::rexglue> codegen ${CMAKE_CURRENT_SOURCE_DIR}/halo3_cache_release_config.toml
    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
    COMMENT "Generating recompiled code for halo3_cache_release"
    VERBATIM
)
